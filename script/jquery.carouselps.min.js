(function(e){e.fn.carouselps=function(t){var n={fade:false,continuous:true,auto_slide:true,arrow_nav:true,bottom_nav:true,show_title:true,use_css3:true,swipe:true,adjust_height:false,slideChangeSpeed:5e3,animateSpeed:500};t=e.extend({},n,t);return this.each(function(){var n=e(this),r=n.children("li"),i=n.children("li:first-child"),s=n.children("li:last-child"),o=n.find(".current"),u,a,f,l,c,h,p,d=css3support=false,v,m,g=n.find("iframe").length,y=n.find("iframe"),b=false,w,E=[],S,x,T,N=/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent.toLowerCase());var C={init:function(){n.wrap("<div class='slider-wrapper'><div class='slider-wrap'/></div>");if(!n.hasClass("slider")){n.removeClass().addClass("slider")}l=n.parents(".slider-wrapper");f=n.parent();i.addClass("current");if(t.arrow_nav){C.arrow_nav()}if(t.bottom_nav){C.bottom_nav()}if(t.show_title){C.show_title()}if(t.fade){C.fade()}if(t.continuous){C.continuous()}o=n.find(".current");if(t.use_css3){C.use_css3()}C.calcs();if(t.auto_slide){C.auto_slide()}if(t.swipe){C.swipe()}},fade:function(){t.continuous=t.use_css3=false;t.adjust_height=true;r.css("position","absolute");r.hide();i.show()},use_css3:function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var r in t){if(e.style[t[r]]!=undefined){css3support=true;x=t[r].replace("Perspective","").toLowerCase();S="-"+x+"-transform";n.css("-"+x+"-transition-property","-"+x+"-transform");n.css("-"+x+"-transition-duration","0s");n.css("-"+x+"-transition-timing-function","ease-out");return true}}},calcs:function(){r.width(f.innerWidth());if(!t.fade){if(t.use_css3&&css3support){n.css("-"+x+"-transition-duration","0s");n.css(S,"translate3d("+o.position().left*-1+"px, 0, 0)")}else{n.css("margin-left",""+o.position().left*-1+"px")}}if(t.adjust_height){n.height(o.height())}},continuous:function(){i.clone(true).insertAfter(s).addClass("clone").removeClass("current");s.clone(true).insertBefore(i).addClass("clone");u=n.find("li:first-child");a=n.find("li:last-child");r=n.children("li")},animate:function(){if(!d){d=true;if(t.auto_slide){clearTimeout(T)}switch(v){case"prev":if(!i.hasClass("current")||t.continuous){o.removeClass("current").prev().addClass("current")}else{o.removeClass("current");s.addClass("current")}break;case"next":if(!s.hasClass("current")||t.continuous){o.removeClass("current").next().addClass("current")}else{o.removeClass("current");i.addClass("current")}break;case"bottom":o.removeClass("current");var e=t.continuous?p+1:p;r.eq(e).addClass("current");break}o=n.find(".current");if(t.use_css3&&css3support){n.css("-"+x+"-transition-duration",t.animateSpeed/1e3+"s");n.css(S,"translate3d("+o.position().left*-1+"px, 0, 0)")}else{if(t.fade){r.fadeOut(t.animateSpeed);o.fadeIn(t.animateSpeed)}else{n.animate({marginLeft:o.position().left*-1},{duration:t.animateSpeed,queue:false})}}if(t.bottom_nav){h.removeClass("current");var e=t.continuous?a.hasClass("current")?i.index()-1:o.index()-1:o.index();h.eq(e).addClass("current")}if(n.height()!=o.height()&&t.adjust_height){n.animate({height:o.height()},{duration:t.animateSpeed,queue:false})}setTimeout(C.after_anim,t.animateSpeed+100)}if(t.auto_slide){b=false}},after_anim:function(){if(t.continuous){if(u.hasClass("current")||a.hasClass("current")){var e=u.hasClass("current")?s.position().left*-1:i.position().left*-1;if(t.use_css3&&css3support){n.css("-"+x+"-transition-duration","0s");n.css(S,"translate3d("+e+"px, 0, 0)")}else{n.css("margin-left"," "+e+"px")}if(u.hasClass("current")){s.addClass("current")}if(a.hasClass("current")){i.addClass("current")}o.removeClass("current");cloneUsed=true}o=n.find(".current")}d=false;if(t.auto_slide){v="next";T=setTimeout(C.animate,t.slideChangeSpeed)}},auto_slide:function(){v="next";T=setTimeout(C.animate,t.slideChangeSpeed);l.hover(function(){clearTimeout(T)},function(){if(!b){T=setTimeout(C.animate,t.slideChangeSpeed)}})},swipe:function(){function r(n){if(!d){if(t.auto_slide){clearTimeout(T)}if(n.originalEvent.touches){n=n.originalEvent.touches[0]}if(e==0){e=1;startX=n.clientX;startY=n.clientY}}}function i(r){r.preventDefault();if(r.originalEvent.touches){r=r.originalEvent.touches[0]}swipeDistanceX=r.clientX-startX;swipeDistanceY=r.clientY-startY;if(swipeDistanceY>30||swipeDistanceY<-30){return true}if(e==1&&swipeDistanceX!=0){if(t.auto_slide&&T){clearTimeout(T)}e=2;startXOffset=movementXOffset}if(e==2&&!t.fade&&css3support){movementXOffset=o.position().left*-1+swipeDistanceX;n.css("-"+x+"-transition-duration","0s");n.css(S,"translate3d("+movementXOffset+"px,0,0)")}}function s(r){if(e==2){e=0;if(swipeDistanceX>80||swipeDistanceX<-80){if(swipeDistanceX>80){v="prev"}else if(swipeDistanceX<-80){v="next"}C.animate()}else{if(!t.fade&&css3support){n.css("-"+x+"-transition-duration",t.animateSpeed/1e3+"s");n.css(S,"translate3d("+o.position().left*-1+"px,0,0)")}setTimeout(function(){T=setTimeout(C.animate,t.slideChangeSpeed)},t.animateSpeed)}}}var e=startX=startY=startXOffset=movementXOffset=startYOffset=movementYOffset=swipeDistanceX=swipeDistanceY=0;n.find("img").on("touchstart",r);n.find("img").on("touchend",s);n.find("img").on("touchmove",i)},arrow_nav:function(){f.append('<ul class="slider-nav"><li class="prev"><a><</a></li><li class="next"><a>></a></li></ul>');$sliderBottomNavItem=f.find(".slider-nav li");$sliderBottomNavItem.click(function(){v=e(this).attr("class");C.animate()})},bottom_nav:function(){l.append('<ul class="slider-nav-bottom"/>');c=l.find(".slider-nav-bottom");r.each(function(){c.append("<li><a/></li>")});h=c.find("li");c.find("li:first-child").addClass("current");h.click(function(){p=parseInt(e(this).index());v="bottom";C.animate()})},show_title:function(){r.each(function(){var t=e(this).attr("title");if(!t==""){e(this).append('<span class="title"></span>');e(this).find(".title").text(t);e(this).removeAttr("title")}})},youtube_exists:function(){y=n.find("iframe");y.each(function(){var t=e(this).height()/e(this).width()*100+"%";e(this).wrap("<div class='video-wrapper' style='padding-bottom: "+t+"' />");e(this).css({position:"absolute",height:"100%",width:"100%",top:"0",left:"0"})});y.hover(function(){if(T){clearTimeout(T)}b=true})}};C.init();e(window).load(function(){if(g){C.youtube_exists()}if(t.adjust_height){n.height(o.height())}});e(window).resize(function(){if(m){clearTimeout(m)}m=setTimeout(function(){C.calcs()},100)})})}})(jQuery)