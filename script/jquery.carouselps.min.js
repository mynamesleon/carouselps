/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~                   Carousel Plugin                   ~~
~~           Leon Slater, www.lpslater.co.uk           ~~
~~                    Version 1.1.1                    ~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
(function(e){e.fn.carouselps=function(t){var n={fade:false,continuous:true,auto_slide:true,auto_direction:"next",arrow_nav:true,bottom_nav:true,custom_bottom_nav:false,use_css3:true,swipe:true,swipe_threshold:100,responsive:true,adjust_height:false,slide_delay:2500,animate_speed:500,starting_slide:1,visible_slides:1,load_callback:function(e){},slide_start:function(e){},slide_end:function(e){},bottom_nav_click:function(e,t){},arrow_click:function(e,t){}};t=e.extend({},n,t);return this.each(function(){var n=e(this),r=n.children(),i=r.length,s=r.eq(0),o=r.eq(i-1),u,a,f,l,c,h,p,d,v,m=false,g=false,y,b=false,w=false,E,S,x,T=/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent.toLowerCase());var N={init:function(){n.addClass("carouselps").wrap("<div class='carouselps-wrapper'><div class='carouselps-wrap'/></div>");l=n.parent();c=l.parent();a=r.eq(t.starting_slide-1);a.addClass("current");if(t.arrow_nav){N.arrow_nav()}if(t.bottom_nav){N.bottom_nav()}if(t.fade){N.fade()}if(t.continuous){N.continuous()}if(t.use_css3){N.use_css3()}N.calcs();if(t.auto_slide){N.auto_slide()}if(t.swipe){N.swipe()}if(typeof t.load_callback=="function"){t.load_callback(n)}},fade:function(){t.continuous=false;t.visible_slides=1;r.css({position:"absolute",opacity:"0","z-index":"1"});a.css({opacity:"1","z-index":"2"})},use_css3:function(){var e=document.createElement("div"),i=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var s in i){if(e.style[i[s]]!==undefined){g=true;S=i[s].replace("Perspective","").toLowerCase();E="-"+S+"-transform"}}if(g){if(t.fade){r.css("-"+S+"-transition","opacity 0s ease-out")}else{n.css("-"+S+"-transition","-"+S+"-transform 0s ease-out")}}},calcs:function(){r.width(l.width()/t.visible_slides);f=a.position().left*-1;if(!t.fade){if(g){n.css("-"+S+"-transition-duration","0s").css(E,"translate3d("+f+"px, 0, 0)")}else{n.css("margin-left",""+f+"px")}}if(t.adjust_height){n.height(a.height())}},continuous:function(){n.prepend(r.clone(true).removeClass("current").addClass("clone clone-before")).append(r.clone(true).removeClass("current").addClass("clone clone-after"));r=n.children()},before_anim:function(){a.removeClass("current");switch(y){case"prev":if(!s.is(a)||t.continuous){a.prev().addClass("current")}else{o.addClass("current")}break;case"next":if(!o.is(a)||t.continuous){a.next().addClass("current")}else{s.addClass("current")}break;case"bottom":var e=t.continuous?v+i:v;r.eq(e).addClass("current");break;default:a.addClass("current");break}a=n.find(".current");if(typeof t.slide_start=="function"){t.slide_start(n)}},animate:function(){if(!m){m=true;N.before_anim();f=a.position().left*-1;if(g){d=t.fade?w?u:a:n;d.bind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",N.after_anim).css("-"+S+"-transition-duration",t.animate_speed/1e3+"s");if(t.fade){a.css("opacity","1");if(w){u.css("opacity","0")}else{r.css("z-index","1");a.css("z-index","2")}}else{n.css(E,"translate3d("+f+"px, 0, 0)")}}else{if(t.fade){r.css("z-index","1");a.css("z-index","2").animate({opacity:"1"},t.animate_speed,function(){N.after_anim()})}else{n.animate({marginLeft:f},t.animate_speed,N.after_anim)}}if(t.bottom_nav){p.removeClass("current");var e=t.continuous?a.hasClass("clone-after")?0:a.index()-i:a.index();p.eq(e).addClass("current")}if(t.adjust_height){n.animate({height:a.height()},{duration:t.animate_speed,queue:false})}}},after_anim:function(){if(g){d.unbind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",N.after_anim)}if(t.continuous){if(a.hasClass("clone")){var e=a.hasClass("clone-before");f=e?o.position().left*-1:s.position().left*-1;if(t.use_css3&&g){n.css("-"+S+"-transition-duration","0s");n.css(E,"translate3d("+f+"px, 0, 0)")}else{n.css("margin-left"," "+f+"px")}if(e){o.addClass("current")}else{s.addClass("current")}a.removeClass("current")}a=n.find(".current")}if(t.fade){if(g){r.css("-"+S+"-transition-duration","0s");if(w){r.css("z-index","1");a.css("z-index","2")}}r.not(a).css("opacity","0")}m=false;w=false;if(t.auto_slide){if(x){clearTimeout(x)}if(!b){y=t.auto_direction;x=setTimeout(N.animate,t.slide_delay)}}if(typeof t.slide_end=="function"){t.slide_end(n)}},auto_slide:function(){y=t.auto_direction;x=setTimeout(N.animate,t.slide_delay);c.hover(function(){b=true;if(x){clearTimeout(x)}},function(){b=false;y=t.auto_direction;x=setTimeout(N.animate,t.slide_delay)})},swipe:function(){function F(){i=0;c=0;h=0;p=0;v=true;b=-1;T=null;d=0;n.off(P,q).off(H,R);e("html").css({"-ms-touch-action":"auto","touch-action":"auto"});if(O){e("html").unbind(P,q).unbind(H,R)}}function I(r){if(!m){if(O?b===-1&&(r.originalEvent.pointerType==="touch"||r.originalEvent.pointerType===2):!r.originalEvent.targetTouches[1]){d=1;var s=O?r.originalEvent:r.originalEvent.targetTouches[0];i=s.clientX;h=s.clientY;if(g){if(t.fade){a.css("-"+S+"-transition-duration","0s")}else{n.css("-"+S+"-transition-duration","0s")}}n.bind(P,q).bind(H,R);b=O?r.originalEvent.pointerId:r.originalEvent.targetTouches[0].identifier;e("html").css({"-ms-touch-action":"none","touch-action":"none"});if(O){e("html").bind(P,q).bind(H,R)}}}}function q(e){if(O?b===e.originalEvent.pointerId&&(e.originalEvent.pointerType==="touch"||e.originalEvent.pointerType===2):b===e.originalEvent.targetTouches[0].identifier){var r=O?e.originalEvent:e.originalEvent.targetTouches[0];c=r.clientX-i;p=r.clientY-h;if(d===1){var m={horizontal:Math.abs(p)>Math.abs(c),vertical:Math.abs(p)<Math.abs(c),all:false};v=m[C]}if(!v){e.preventDefault();d=2;if(t.auto_slide){clearTimeout(x)}if(g&&!t.fade){movementXOffset=f+c;n.css(E,"translate3d("+movementXOffset+"px,0,0)")}else if(t.fade){if(c!==0){u=c>0?a.is(s)?o:a.prev():c<0?a.is(o)?s:a.next():a;u.css({"z-index":"3",opacity:0+Math.abs(c)/l.innerWidth()})}}}else{F()}}}function R(e){if(O?b===e.originalEvent.pointerId&&(e.originalEvent.pointerType==="touch"||e.originalEvent.pointerType===2):!e.originalEvent.targetTouches.length){if(!v){if(C==="horizontal"){T=c>t.swipe_threshold?"right":c<-t.swipe_threshold?"left":"notReached"}else if(C==="vertical"){T=p>t.swipe_threshold?"down":p<-t.swipe_threshold?"up":"notReached"}else{T=null}switch(T){case"left":y="next";break;case"right":y="prev";break;case"up":break;case"down":break;case"notReached":w=true;y=null;break}N.animate()}F()}}var r={start:{IEedge:"pointerdown",IE10:"MSPointerDown",webkit:"touchstart"},move:{IEedge:"pointermove",IE10:"MSPointerMove",webkit:"touchmove"},end:{IEedge:"pointerup",IE10:"MSPointerUp",webkit:"touchend"},cancel:{IEedge:"pointercancel",IE10:"MSPointerCancel",webkit:"touchcancel"}};var i=0,c=0,h=0,p=0,d=0,v=true,b=-1,T=null,C="horizontal",k="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,L=window.navigator.pointerEnabled,A=window.navigator.msPointerEnabled,O=k?L||A:false,M=O?L?"IEedge":"IE10":"webkit",_=r.cancel[M],D=r.start[M],P=r.move[M],H=r.end[M];var B={horizontal:"pan-y",vertical:"pan-x",all:"none"},j=B[t.swipeDirection];n.css({"-ms-touch-action":j,"touch-action":j}).bind(D,I).bind(_,F)},arrow_nav:function(){l.append('<span class="carouselps-arrow prev" data-direction="prev"><a></a></span><span class="carouselps-arrow next" data-direction="next"><a></a></span>');l.children(".carouselps-arrow").bind("click",function(){y=e(this).data("direction");N.animate();if(typeof t.arrow_click=="function"){t.arrow_click(n,e(this))}})},bottom_nav:function(){if(typeof t.custom_bottom_nav=="object"){p=t.custom_bottom_nav}else{c.append('<ul class="carouselps-nav-bottom"/>');h=c.children(".carouselps-nav-bottom");for(var r=0;r<i;r++){h.append("<li><a></a></li>")}p=h.children()}p.eq(t.starting_slide-1).addClass("current");p.bind("click",function(r){r.preventDefault();if(!e(this).hasClass("current")){v=e(this).index();y="bottom";N.animate()}if(typeof t.bottom_nav_click=="function"){t.bottom_nav_click(n,e(this))}})}};N.init();e(window).bind("load",function(){if(t.adjust_height){n.height(a.height())}if(t.responsive){N.calcs()}});if(t.responsive){var C,k=T?window.hasOwnProperty("orientation"):false,L=k?"orientationchange":"resize";e(window).bind(L,function(){if(C){clearTimeout(C)}C=setTimeout(N.calcs,100)})}})}})(jQuery)