/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~                   Carousel Plugin                   ~~
~~           Leon Slater, www.lpslater.co.uk           ~~
~~                    Version 1.2.0                    ~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
(function(e){var t=0;window.carouselpsOptions=[];e.fn.carouselps=function(n){var r={fade:false,continuous:true,starting_slide:1,visible_slides:1,auto_slide:true,auto_direction:"next",slide_delay:2500,arrow_nav:true,bottom_nav:true,custom_bottom_nav:false,use_css3:true,swipe:true,swipe_threshold:100,responsive:true,adjust_height:false,adjust_height_after:false,animate_speed:500,load_callback:function(e){},slide_start:function(e){},slide_end:function(e){},bottom_nav_click:function(e){},arrow_click:function(e){},swipe_start:function(e){},swipe_move:function(e){},swipe_end:function(e){}};n=e.extend({},r,n);return this.each(function(){var r=e(this),i=r.children(),s=i.length,o=i.eq(0),u=i.eq(s-1),a,f,l,c,h,p,d,v,m,g,y=false,b=false,w,E=false,S=false,x,T,N,C=/android|webos|iphone|ipad|ipod|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase()),k=t;window.carouselpsOptions.push({});var L=window.carouselpsOptions[k];t++;var A={init:function(){r.addClass("carouselps").wrap("<div class='carouselps-wrapper'><div class='carouselps-wrap'/></div>");h=r.parent();p=h.parent();f=i.eq(n.starting_slide-1);f.addClass("current");if(n.arrow_nav){A.arrow_nav()}if(n.bottom_nav){A.bottom_nav()}if(n.fade){A.fade()}if(n.continuous){A.continuous()}if(n.use_css3){A.use_css3()}A.calcs();if(n.auto_slide){A.auto_slide()}if(n.swipe){A.swipe()}l=f.index();if(typeof n.load_callback=="function"){var e={$slider:r,$slides:i,$currentSlide:f};n.load_callback(e)}},fade:function(){n.continuous=false;n.visible_slides=1;i.css({position:"absolute",opacity:"0","z-index":"1"});f.css({opacity:"1","z-index":"2"})},use_css3:function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var s in t){if(e.style[t[s]]!==undefined){b=true;T=t[s].replace("Perspective","").toLowerCase();x="-"+T+"-transform"}}if(b){if(n.fade){var o={};o["-"+T+"-transition"]="opacity 0s ease-out";o[x]="translate3d(0,0,0)";i.css(o)}else{r.css("-"+T+"-transition","-"+T+"-transform 0s ease-out")}}},calcs:function(){i.width(h.width()/n.visible_slides);c=f.position().left*-1;if(!n.fade){if(b){var e={};e["-"+T+"-transition-duration"]="0s";e[x]="translate3d("+c+"px, 0, 0)";r.css(e)}else{r.css("margin-left",""+c+"px")}}if(n.adjust_height){r.height(f.height())}},continuous:function(){r.prepend(i.clone(true).removeClass("current").addClass("clone clone-before")).append(i.clone(true).removeClass("current").addClass("clone clone-after"));i=r.children()},before_anim:function(){f.removeClass("current");var e;switch(w){case"prev":if(!o.is(f)||n.continuous){e=l-1}else{e=u.index()}break;case"next":if(!u.is(f)||n.continuous){e=l+1}else{e=o.index()}break;case"bottom":e=n.continuous?g+s:g;break;default:e=l;break}var t=e>l?"next":e<l?"prev":null,a=f;f=i.eq(e);L.preventSlide=false;if(typeof n.slide_start=="function"){var c={$slider:r,$slides:i,$nextSlide:f,$currentSlide:a,direction:t,sliderIndex:k};n.slide_start(c)}if(L.preventSlide){f.removeClass("current");f=a}l=f.index();f.addClass("current")},animate:function(){if(!y){y=true;A.before_anim();if(L.preventSlide){y=false;return false}c=f.position().left*-1;if(b){m=n.fade?S?a:f:r;m.bind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",A.after_anim).css("-"+T+"-transition-duration",n.animate_speed/1e3+"s");if(n.fade){f.css("opacity","1");if(S){a.css("opacity","0")}else{i.css("z-index","1");f.css("z-index","2")}}else{r.css(x,"translate3d("+c+"px, 0, 0)")}}else{if(n.fade){i.css("z-index","1");f.css("z-index","2").animate({opacity:"1"},n.animate_speed,A.after_anim)}else{r.animate({marginLeft:c},n.animate_speed,A.after_anim)}}if(n.bottom_nav){v.removeClass("current");var e=n.continuous?f.hasClass("clone-after")?0:l-s:l;v.eq(e).addClass("current")}if(n.adjust_height&&!n.adjust_height_after){r.animate({height:f.height()},{duration:n.animate_speed,queue:false})}}},after_anim:function(e){if(b){m.unbind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",A.after_anim)}if(n.continuous){if(f.hasClass("clone")){f.removeClass("current");if(f.hasClass("clone-before")){f=u}else{f=o}f.addClass("current");l=f.index();c=f.position().left*-1;if(n.use_css3&&b){var t={};t["-"+T+"-transition-duration"]="0s";t[x]="translate3d("+c+"px, 0, 0)";r.css(t)}else{r.css("margin-left"," "+c+"px")}}}if(n.fade){if(b){i.css("-"+T+"-transition-duration","0s");if(S){i.css("z-index","1");f.css("z-index","2")}}i.css("opacity","0");f.css("opacity","1")}if(n.adjust_height&&n.adjust_height_after){r.stop().animate({height:f.height()},{duration:n.animate_speed,queue:false})}y=false;S=false;if(n.auto_slide){if(N){clearTimeout(N)}if(!E){w=n.auto_direction;N=setTimeout(A.animate,n.slide_delay)}}if(typeof n.slide_end=="function"){var s={$slider:r,$slides:i,$currentSlide:f};n.slide_end(s)}},auto_slide:function(){w=n.auto_direction;N=setTimeout(A.animate,n.slide_delay);p.hover(function(){E=true;if(N){clearTimeout(N)}},function(){E=false;w=n.auto_direction;N=setTimeout(A.animate,n.slide_delay)})},swipe:function(){if("ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0){var t=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame;var s={start:{IEedge:"pointerdown",IE10:"MSPointerDown",webkit:"touchstart"},move:{IEedge:"pointermove",IE10:"MSPointerMove",webkit:"touchmove"},end:{IEedge:"pointerup",IE10:"MSPointerUp",webkit:"touchend"},cancel:{IEedge:"pointercancel",IE10:"MSPointerCancel",webkit:"touchcancel"}},p=0,d=0,v=0,m=0,g=true,E=-1,C=null,O="horizontal",M=window.navigator.pointerEnabled,_=window.navigator.msPointerEnabled,D=M||_,P=D?M?"IEedge":"IE10":"webkit",H=s.cancel[P],B=s.start[P],j=s.move[P],F=s.end[P],I,q={horizontal:"pan-y",vertical:"pan-x",all:"none"}[O];function R(){p=0;d=0;v=0;m=0;g=true;E=-1;C=null;r.off(j,W).off(F,X);e("html").css({"-ms-touch-action":"auto","touch-action":"auto"});if(D){e("html").unbind(j,W).unbind(F,X)}}function U(e,t){var n;switch(t){case"start":n=E===-1;break;case"move":if(D){n=E===e.originalEvent.pointerId}else{n=E===e.originalEvent.targetTouches[0].identifier}break;case"end":if(D){n=E===e.originalEvent.pointerId}else{n=E===e.originalEvent.changedTouches[0].identifier}break}if(D&&n){n=e.originalEvent.pointerType==="touch"||e.originalEvent.pointerType===2}return n}function z(t){if(!y){if(U(t,"start")){var s=D?t.originalEvent:t.originalEvent.targetTouches[0];p=s.clientX;v=s.clientY;if(b){if(n.fade){f.css("-"+T+"-transition-duration","0s")}else{r.css("-"+T+"-transition-duration","0s")}}I=h.innerWidth();r.bind(j,W).bind(F,X);E=D?t.originalEvent.pointerId:t.originalEvent.targetTouches[0].identifier;e("html").css({"-ms-touch-action":"none","touch-action":"none"});if(D){e("html").bind(j,W).bind(F,X)}if(typeof n.swipe_start=="function"){var o={$slider:r,$slides:i,$currentSlide:f};n.swipe_start(o)}}}}function W(e){if(U(e,"move")){var s=D?e.originalEvent:e.originalEvent.targetTouches[0];d=s.clientX-p;m=s.clientY-v;var h=Math.abs(d);if(g){var y={horizontal:Math.abs(m)>h,vertical:Math.abs(m)<h,all:false};g=y[O]}if(!g){e.preventDefault();if(n.auto_slide){clearTimeout(N)}t(function(){L.preventSwipe=false;if(typeof n.swipe_move=="function"){var e={$slider:r,$slides:i,$currentSlide:f,posX:d,sliderIndex:k};n.swipe_move(e)}if(L.preventSwipe){return false}if(b&&!n.fade){movementXOffset=c+d;r.css(x,"translate3d("+movementXOffset+"px,0,0)")}else if(n.fade){if(d!==0){if(d>0){if(f.is(o)){a=u}else{a=i.eq(l-1)}}else{if(f.is(u)){a=o}else{a=i.eq(l+1)}}a.css({"z-index":"3",opacity:0+h/I})}}})}else{R()}}}function X(e){if(U(e,"end")){if(!g&&!L.preventSwipe){if(O==="horizontal"){C=d>n.swipe_threshold?"right":d<-n.swipe_threshold?"left":"notReached"}else if(O==="vertical"){C=m>n.swipe_threshold?"down":m<-n.swipe_threshold?"up":"notReached"}else{C=null}switch(C){case"left":case"up":w="next";break;case"right":case"down":w="prev";break;case"notReached":S=true;w=null;break}if(typeof n.swipe_end=="function"){var t={$slider:r,$slides:i,$currentSlide:f,posX:d,sliderIndex:k};n.swipe_end(t)}A.animate()}R()}}r.css({"-ms-touch-action":q,"touch-action":q}).bind(B,z).bind(H,R)}},arrow_nav:function(){h.append('<span class="carouselps-arrow prev" data-direction="prev"><a></a></span><span class="carouselps-arrow next" data-direction="next"><a></a></span>');h.children(".carouselps-arrow").bind("click",function(t){t.preventDefault();var s=e(this);w=s.data("direction");A.animate();if(typeof n.arrow_click=="function"){var o={$slider:r,$slides:i,$clickedItem:s,direction:w};n.arrow_click(o)}})},bottom_nav:function(){if(typeof n.custom_bottom_nav=="object"){v=n.custom_bottom_nav}else{p.append('<ul class="carouselps-nav-bottom"/>');d=p.children(".carouselps-nav-bottom");for(var t=0;t<s;t++){d.append("<li><a></a></li>")}v=d.children()}v.eq(n.starting_slide-1).addClass("current");v.bind("click",function(t){t.preventDefault();var s=e(this);if(!s.hasClass("current")){g=s.index();w="bottom";A.animate()}if(typeof n.bottom_nav_click=="function"){var o={$slider:r,$slides:i,$clickedItem:s};n.bottom_nav_click(o)}})}};A.init();e(window).bind("load",function(){if(n.adjust_height){r.height(f.height())}if(n.responsive){A.calcs()}});if(n.responsive){var O,M=C?window.hasOwnProperty("orientation"):false,_=M?"orientationchange":"resize";e(window).bind(_,function(){if(O){clearTimeout(O)}O=setTimeout(A.calcs,M?200:100)})}})}})(jQuery)
