/*
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~                   Carousel Plugin                   ~~
~~           Leon Slater, www.lpslater.co.uk           ~~
~~                    Version 1.1.0                    ~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
*/
(function(e){e.fn.carouselps=function(t){var n={fade:false,continuous:true,auto_slide:true,auto_direction:"next",arrow_nav:true,bottom_nav:true,custom_bottom_nav:false,use_css3:true,swipe:true,swipe_threshold:100,responsive:true,adjust_height:false,slide_delay:2500,animate_speed:500,starting_slide:1,load_callback:function(e){},slide_start:function(e){},slide_end:function(e){},bottom_nav_click:function(e,t){},arrow_click:function(e,t){}};t=e.extend({},n,t);return this.each(function(){var n=e(this),r=n.children(),i=r.length,s=n.children(":first-child"),o=n.children(":last-child"),u=n.find(".current"),a,f,l,c,h,p,d=false,v=false,m,g=false,y,b,w,E=/android|webos|iphone|ipad|ipod|blackberry/i.test(navigator.userAgent.toLowerCase());var S={init:function(){var e=t.vertical?"carouselps vertical":"carouselps horizontal";n.addClass(e).wrap("<div class='carouselps-wrapper'><div class='carouselps-wrap'/></div>");l=n.parents(".carouselps-wrapper");f=n.parent();r.eq(t.starting_slide-1).addClass("current");if(t.arrow_nav){S.arrow_nav()}if(t.bottom_nav){S.bottom_nav()}if(t.fade){S.fade()}if(t.continuous){S.continuous()}u=n.find(".current");if(t.use_css3){S.use_css3()}S.calcs();if(t.auto_slide){S.auto_slide()}if(t.swipe){S.swipe()}if(typeof t.load_callback=="function"){t.load_callback(n)}},fade:function(){t.continuous=t.use_css3=false;r.css({position:"absolute",opacity:"0","z-index":"1"});r.eq(t.starting_slide-1).css({opacity:"1","z-index":"2"})},use_css3:function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var r in t){if(e.style[t[r]]!==undefined){v=true;b=t[r].replace("Perspective","").toLowerCase();y="-"+b+"-transform";n.css("-"+b+"-transition","-"+b+"-transform 0s ease-out")}}},calcs:function(){r.width(f.width());a=u.position().left*-1;if(!t.fade){if(t.use_css3&&v){n.css("-"+b+"-transition-duration","0s").css(y,"translate3d("+a+"px, 0, 0)")}else{n.css("margin-left",""+a+"px")}}if(t.adjust_height){n.height(u.height())}},continuous:function(){n.prepend(r.clone(true).removeClass("current").addClass("clone clone-before")).append(r.clone(true).removeClass("current").addClass("clone clone-after"));r=n.children()},before_anim:function(){u.removeClass("current");switch(m){case"prev":if(!s.is(u)||t.continuous){u.prev().addClass("current")}else{o.addClass("current")}break;case"next":if(!o.is(u)||t.continuous){u.next().addClass("current")}else{s.addClass("current")}break;case"bottom":var e=t.continuous?p+i:p;r.eq(e).addClass("current");break;default:u.addClass("current");break}u=n.find(".current");if(typeof t.slide_start=="function"){t.slide_start(n)}},animate:function(){if(!d){d=true;S.before_anim();a=u.position().left*-1;if(t.use_css3&&v){n.css("-"+b+"-transition-duration",t.animate_speed/1e3+"s").css(y,"translate3d("+a+"px, 0, 0)").one("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",S.after_anim)}else{if(t.fade){r.css("z-index","1");u.css("z-index","2").animate({opacity:"1"},t.animate_speed,function(){S.after_anim()})}else{n.animate({marginLeft:a},t.animate_speed,S.after_anim)}}if(t.bottom_nav){h.removeClass("current");var e=t.continuous?u.hasClass("clone-after")?0:u.index()-i:u.index();h.eq(e).addClass("current")}if(t.adjust_height){n.animate({height:u.height()},{duration:t.animate_speed,queue:false})}}},after_anim:function(){if(t.continuous){if(u.hasClass("clone")){var e=u.hasClass("clone-before");a=e?o.position().left*-1:s.position().left*-1;if(t.use_css3&&v){n.css("-"+b+"-transition-duration","0s");n.css(y,"translate3d("+a+"px, 0, 0)")}else{n.css("margin-left"," "+a+"px")}if(e){o.addClass("current")}else{s.addClass("current")}u.removeClass("current")}u=n.find(".current")}if(t.fade){r.not(u).css("opacity","0")}d=false;if(t.auto_slide){if(w){clearTimeout(w)}if(!g){m=t.auto_direction;w=setTimeout(S.animate,t.slide_delay)}}if(typeof t.slide_end=="function"){t.slide_end(n)}},auto_slide:function(){m=t.auto_direction;w=setTimeout(S.animate,t.slide_delay);l.hover(function(){g=true;if(w){clearTimeout(w)}},function(){g=false;m=t.auto_direction;w=setTimeout(S.animate,t.slide_delay)})},swipe:function(){function L(t){if(!d){if(E?t.originalEvent.pointerType==="touch":x?t.originalEvent.pointerType===2:!t.originalEvent.touches[1]){if(p===0){p=1;T=E||x?t.originalEvent:t.originalEvent.touches[0];e=T.clientX;r=T.clientY;n.css("-"+b+"-transition-duration","0s").on(C,A).on(k,O)}}}}function A(l){if(p!==0){T=E||x?l.originalEvent:l.originalEvent.touches[0];c=T.clientX-e;h=T.clientY-r;if(p===1){g=Math.abs(c)<Math.abs(h)}if(!g){l.preventDefault();if(t.auto_slide){clearTimeout(w)}p=2;if(v){i=a+c;n.css(y,"translate3d("+i+"px,0,0)")}else if(t.fade){var d=c>0?u.is(s)?o:u.prev():c<0?u.is(o)?s:u.next():u;d.css({"z-index":"3",opacity:0+Math.abs(c)/f.innerWidth()})}}else{p=0}}}function O(s){if(p===2){if(c>t.swipe_threshold){m="prev"}else if(c<-t.swipe_threshold){m="next"}else{m="default"}S.animate();e=0,r=0,i=0,l=0,c=0,h=0,p=0,g=true;n.off(C).off(k)}}var e=0,r=0,i=0,l=0,c=0,h=0,p=0,g=true,E=window.navigator.pointerEnabled,x=window.navigator.msPointerEnabled,T,N=E?"pointerdown":x?"MSPointerDown":"touchstart",C=E?"pointermove":x?"MSPointerMove":"touchmove",k=E?"pointerup":x?"MSPointerUp":"touchend";if(E||x){n.css({"touch-action":"pan-y","-ms-touch-action":"pan-y"})}n.on(N,L)},arrow_nav:function(){f.append('<span class="carouselps-arrow prev" data-direction="prev"><a></a></span><span class="carouselps-arrow next" data-direction="next"><a></a></span>');f.find(".carouselps-arrow").bind("click",function(){m=e(this).data("direction");S.animate();if(typeof t.arrow_click=="function"){t.arrow_click(n,e(this))}})},bottom_nav:function(){if(typeof t.custom_bottom_nav=="object"){h=t.custom_bottom_nav}else{l.append('<ul class="carouselps-nav-bottom"/>');c=l.find(".carouselps-nav-bottom");r.each(function(){c.append("<li><a></a></li>")});h=c.children()}h.eq(t.starting_slide-1).addClass("current");h.bind("click",function(r){r.preventDefault();if(!e(this).hasClass("current")){p=e(this).index();m="bottom";S.animate()}if(typeof t.bottom_nav_click=="function"){t.bottom_nav_click(n,e(this))}})}};S.init();e(window).bind("load",function(){if(t.adjust_height){n.height(u.height())}});if(t.responsive){var x,T=E?window.hasOwnProperty("orientation"):false,N=T?"orientationchange":"resize";e(window).bind(N,function(){if(x){clearTimeout(x)}x=setTimeout(S.calcs,100)})}})}})(jQuery)