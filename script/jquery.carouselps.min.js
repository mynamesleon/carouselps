(function(e){e.fn.carouselps=function(t){var n={fade:true,continuous:true,auto_slide:true,arrow_nav:true,bottom_nav:true,show_title:true,use_css3:true,slideChangeSpeed:5e3,animateSpeed:500};t=e.extend({},n,t);return this.each(function(){var n=e(this),r=n.children("li"),i=n.children("li:first-child"),s=n.children("li:last-child"),o=n.find(".current"),u,a,f,l,c,h,p,d=css3support=false,v,m,g=n.find("iframe").length,y=false,b,w=[],E,S;var x={init:function(){n.wrap("<div class='slider-wrapper'><div class='slider-wrap'/></div>");if(!n.hasClass("slider")){n.removeClass().addClass("slider")}l=n.parents(".slider-wrapper");f=n.parent();i.addClass("current");if(t.arrow_nav){x.arrow_nav()}if(t.bottom_nav){x.bottom_nav()}if(t.show_title){x.show_title()}if(t.fade){x.fade()}if(t.continuous){x.continuous()}o=n.find(".current");if(t.use_css3){x.use_css3()}x.calcs();if(t.auto_slide){x.auto_slide()}},fade:function(){t.continuous=t.use_css3=false;r.css("position","absolute");r.hide();i.show()},use_css3:function(){var e=document.createElement("div"),t=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var r in t){if(e.style[t[r]]!=undefined){css3support=true;S=t[r].replace("Perspective","").toLowerCase();E="-"+S+"-transform";n.css("-"+S+"-transition-duration","0s");n.css("-"+S+"-transition-timing-function","ease-in-out");return true}}},calcs:function(){r.width(f.innerWidth());if(!t.fade){if(t.use_css3&&css3support){n.css(E,"translate3d("+o.position().left*-1+"px, 0, 0)")}else{n.css("margin-left",""+o.position().left*-1+"px")}}},continuous:function(){s.clone(true).insertBefore(i).addClass("clone");i.clone(true).insertAfter(s).addClass("clone");u=n.find("li:first-child");a=n.find("li:last-child");a.removeClass("current");r=n.children("li")},animate:function(){if(!d){d=true;switch(v){case"prev":if(!i.hasClass("current")||t.continuous){o.removeClass("current").prev().addClass("current")}else{o.removeClass("current");s.addClass("current")}break;case"next":if(!s.hasClass("current")||t.continuous){o.removeClass("current").next().addClass("current")}else{o.removeClass("current");i.addClass("current")}break;case"bottom":o.removeClass("current");var e=t.continuous?p+1:p;r.eq(e).addClass("current");break}o=n.find(".current");if(t.use_css3&&css3support){n.css("-"+S+"-transition-duration",t.animateSpeed/1e3+"s");n.css(E,"translate3d("+o.position().left*-1+"px, 0, 0)")}else{if(t.fade){r.fadeOut(t.animateSpeed);o.fadeIn(t.animateSpeed)}else{n.animate({marginLeft:o.position().left*-1},{duration:t.animateSpeed,queue:false})}}setTimeout(x.after_anim,t.animateSpeed)}if(t.auto_slide){y=false}},after_anim:function(){var e=false;if(t.continuous){if(u.hasClass("current")||a.hasClass("current")){var r=u.hasClass("current")?s.position().left*-1:i.position().left*-1;if(t.use_css3&&css3support){n.css("-"+S+"-transition-duration","0s");n.css(E,"translate3d("+r+"px, 0, 0)")}else{n.css("margin-left"," "+r+"px")}if(u.hasClass("current")){s.addClass("current")}if(a.hasClass("current")){i.addClass("current")}o.removeClass("current");e=true}o=n.find(".current")}if(t.bottom_nav){h.removeClass("current");var f=t.continuous?o.index()-1:o.index();h.eq(f).addClass("current")}if(differentHeights&&n.height()!=o.height()){if(t.use_css3&&css3support&&!e){n.height(o.height())}else{n.animate({height:o.height()},{duration:t.animateSpeed,queue:false})}}d=e=false},auto_slide:function(){function r(){e=setInterval(function(){v="next";x.animate()},t.slideChangeSpeed)}var e;r();l.hover(function(){clearInterval(e)},function(){if(!y){r()}});if(g){n.find("iframe").hover(function(){y=true;clearInterval(e)})}},arrow_nav:function(){f.append('<ul class="slider-nav"><li class="prev"><a><</a></li><li class="next"><a>></a></li></ul>');$sliderBottomNavItem=f.find(".slider-nav li");$sliderBottomNavItem.click(function(){v=e(this).attr("class");x.animate()})},bottom_nav:function(){l.append('<ul class="slider-nav-bottom"/>');c=l.find(".slider-nav-bottom");r.each(function(){c.append("<li><a/></li>")});h=c.find("li");c.find("li:first-child").addClass("current");h.click(function(){p=parseInt(e(this).index());v="bottom";x.animate()})},show_title:function(){r.each(function(){var t=e(this).attr("title");if(!t==""){e(this).append('<span class="title"></span>');e(this).find(".title").text(t);e(this).removeAttr("title")}})},youtube_exists:function(){iframe=n.find("iframe");iframe.each(function(){var t=e(this).height()/e(this).width()*100+"%";e(this).wrap("<div class='video-wrapper' style='padding-bottom: "+t+"' />");e(this).css({position:"absolute",height:"100%",width:"100%",top:"0",left:"0"})})},slider_heights:function(){r.each(function(){w.push(e(this).height())});var t=Math.min.apply(Math,w),n=Math.max.apply(Math,w);if(t!=n){differentHeights=true}}};x.init();e(window).load(function(){if(g){x.youtube_exists()}x.slider_heights();if(differentHeights){n.height(o.height())}});e(window).resize(function(){if(m){clearTimeout(m)}m=setTimeout(function(){x.calcs();if(differentHeights){n.height(o.height())}},100)})})}})(jQuery)