/* ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
~~                   Carousel Plugin                   ~~
~~           Leon Slater, www.lpslater.co.uk           ~~
~~                    Version 1.1.1                    ~~
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~ */
(function(e){e.fn.carouselps=function(t){var n={fade:false,continuous:true,starting_slide:1,visible_slides:1,auto_slide:true,auto_direction:"next",slide_delay:2500,arrow_nav:true,bottom_nav:true,custom_bottom_nav:false,use_css3:true,swipe:true,swipe_threshold:100,responsive:true,adjust_height:false,adjust_height_after:false,animate_speed:500,load_callback:function(e){},slide_start:function(e){},slide_end:function(e){},bottom_nav_click:function(e,t){},arrow_click:function(e,t){}};t=e.extend({},n,t);return this.each(function(){var n=e(this),r=n.children(),i=r.length,s=r.eq(0),o=r.eq(i-1),u,a,f,l,c,h,p,d,v,m,g=false,y=false,b,w=false,E=false,S,x,T,N=/android|webos|iphone|ipad|ipod|blackberry|windows phone/i.test(navigator.userAgent.toLowerCase());var C={init:function(){n.addClass("carouselps").wrap("<div class='carouselps-wrapper'><div class='carouselps-wrap'/></div>");c=n.parent();h=c.parent();a=r.eq(t.starting_slide-1);a.addClass("current");if(t.arrow_nav){C.arrow_nav()}if(t.bottom_nav){C.bottom_nav()}if(t.fade){C.fade()}if(t.continuous){C.continuous()}if(t.use_css3){C.use_css3()}C.calcs();if(t.auto_slide){C.auto_slide()}if(t.swipe){C.swipe()}f=a.index();if(typeof t.load_callback=="function"){t.load_callback(n)}},fade:function(){t.continuous=false;t.visible_slides=1;r.css({position:"absolute",opacity:"0","z-index":"1"});a.css({opacity:"1","z-index":"2"})},use_css3:function(){var e=document.createElement("div"),i=["WebkitPerspective","MozPerspective","OPerspective","msPerspective"];for(var s in i){if(e.style[i[s]]!==undefined){y=true;x=i[s].replace("Perspective","").toLowerCase();S="-"+x+"-transform"}}if(y){if(t.fade){r.css("-"+x+"-transition","opacity 0s ease-out")}else{n.css("-"+x+"-transition","-"+x+"-transform 0s ease-out")}}},calcs:function(){r.width(c.width()/t.visible_slides);l=a.position().left*-1;if(!t.fade){if(y){var e={};e["-"+x+"-transition-duration"]="0s";e[S]="translate3d("+l+"px, 0, 0)";n.css(e)}else{n.css("margin-left",""+l+"px")}}if(t.adjust_height){n.height(a.height())}},continuous:function(){n.prepend(r.clone(true).removeClass("current").addClass("clone clone-before")).append(r.clone(true).removeClass("current").addClass("clone clone-after"));r=n.children()},before_anim:function(){a.removeClass("current");var e;switch(b){case"prev":if(!s.is(a)||t.continuous){e=f-1}else{e=o.index()}break;case"next":if(!o.is(a)||t.continuous){e=f+1}else{e=s.index()}break;case"bottom":e=t.continuous?m+i:m;break;default:e=f;break}a=r.eq(e);f=a.index();a.addClass("current");if(typeof t.slide_start=="function"){t.slide_start(n)}},animate:function(){if(!g){g=true;C.before_anim();l=a.position().left*-1;if(y){v=t.fade?E?u:a:n;v.bind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",C.after_anim).css("-"+x+"-transition-duration",t.animate_speed/1e3+"s");if(t.fade){a.css("opacity","1");if(E){u.css("opacity","0")}else{r.css("z-index","1");a.css("z-index","2")}}else{n.css(S,"translate3d("+l+"px, 0, 0)")}}else{if(t.fade){r.css("z-index","1");a.css("z-index","2").animate({opacity:"1"},t.animate_speed,C.after_anim)}else{n.animate({marginLeft:l},t.animate_speed,C.after_anim)}}if(t.bottom_nav){d.removeClass("current");var e=t.continuous?a.hasClass("clone-after")?0:f-i:f;d.eq(e).addClass("current")}if(t.adjust_height&&!t.adjust_height_after){n.animate({height:a.height()},{duration:t.animate_speed,queue:false})}}},after_anim:function(){if(y){v.unbind("webkitTransitionEnd otransitionend oTransitionEnd msTransitionEnd transitionend",C.after_anim)}if(t.continuous){if(a.hasClass("clone")){a.removeClass("current");if(a.hasClass("clone-before")){a=o}else{a=s}a.addClass("current");f=a.index();l=a.position().left*-1;if(t.use_css3&&y){var e={};e["-"+x+"-transition-duration"]="0s";e[S]="translate3d("+l+"px, 0, 0)";n.css(e)}else{n.css("margin-left"," "+l+"px")}}}if(t.fade){if(y){r.css("-"+x+"-transition-duration","0s");if(E){r.css("z-index","1");a.css("z-index","2")}}r.not(a).css("opacity","0")}if(t.adjust_height&&t.adjust_height_after){n.stop().animate({height:a.height()},{duration:t.animate_speed,queue:false})}g=false;E=false;if(t.auto_slide){if(T){clearTimeout(T)}if(!w){b=t.auto_direction;T=setTimeout(C.animate,t.slide_delay)}}if(typeof t.slide_end=="function"){t.slide_end(n)}},auto_slide:function(){b=t.auto_direction;T=setTimeout(C.animate,t.slide_delay);h.hover(function(){w=true;if(T){clearTimeout(T)}},function(){w=false;b=t.auto_direction;T=setTimeout(C.animate,t.slide_delay)})},swipe:function(){function q(){h=0;p=0;d=0;v=0;m=true;w=-1;N=null;n.off(H,U).off(B,z);e("html").css({"-ms-touch-action":"auto","touch-action":"auto"});if(M){e("html").unbind(H,U).unbind(B,z)}}function R(r){if(!g){if(M?w===-1&&(r.originalEvent.pointerType==="touch"||r.originalEvent.pointerType===2):!r.originalEvent.targetTouches[1]){var i=M?r.originalEvent:r.originalEvent.targetTouches[0];h=i.clientX;d=i.clientY;if(y){if(t.fade){a.css("-"+x+"-transition-duration","0s")}else{n.css("-"+x+"-transition-duration","0s")}}j=c.innerWidth();n.bind(H,U).bind(B,z);w=M?r.originalEvent.pointerId:r.originalEvent.targetTouches[0].identifier;e("html").css({"-ms-touch-action":"none","touch-action":"none"});if(M){e("html").bind(H,U).bind(B,z)}}}}function U(e){if(M?w===e.originalEvent.pointerId&&(e.originalEvent.pointerType==="touch"||e.originalEvent.pointerType===2):w===e.originalEvent.targetTouches[0].identifier){var i=M?e.originalEvent:e.originalEvent.targetTouches[0];p=i.clientX-h;v=i.clientY-d;var c=Math.abs(p);if(m){var g={horizontal:Math.abs(v)>c,vertical:Math.abs(v)<c,all:false};m=g[k]}if(!m){e.preventDefault();if(t.auto_slide){clearTimeout(T)}if(y&&!t.fade){movementXOffset=l+p;n.css(S,"translate3d("+movementXOffset+"px,0,0)")}else if(t.fade){if(p!==0){var b=p>0?"prev":"next";switch(b){case"prev":if(a.is(s)){u=o}else{u=r.eq(f-1)}break;case"next":if(a.is(o)){u=s}else{u=r.eq(f+1)}break}u.css({"z-index":"3",opacity:0+c/j})}}}else{q()}}}function z(e){if(M?w===e.originalEvent.pointerId&&(e.originalEvent.pointerType==="touch"||e.originalEvent.pointerType===2):!e.originalEvent.targetTouches.length){if(!m){if(k==="horizontal"){N=p>t.swipe_threshold?"right":p<-t.swipe_threshold?"left":"notReached"}else if(k==="vertical"){N=v>t.swipe_threshold?"down":v<-t.swipe_threshold?"up":"notReached"}else{N=null}switch(N){case"left":case"up":b="next";break;case"right":case"down":b="prev";break;case"notReached":E=true;b=null;break}C.animate()}q()}}var i={start:{IEedge:"pointerdown",IE10:"MSPointerDown",webkit:"touchstart"},move:{IEedge:"pointermove",IE10:"MSPointerMove",webkit:"touchmove"},end:{IEedge:"pointerup",IE10:"MSPointerUp",webkit:"touchend"},cancel:{IEedge:"pointercancel",IE10:"MSPointerCancel",webkit:"touchcancel"}};var h=0,p=0,d=0,v=0,m=true,w=-1,N=null,k="horizontal",L="ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0,A=window.navigator.pointerEnabled,O=window.navigator.msPointerEnabled,M=L?A||O:false,_=M?A?"IEedge":"IE10":"webkit",D=i.cancel[_],P=i.start[_],H=i.move[_],B=i.end[_],j;var F={horizontal:"pan-y",vertical:"pan-x",all:"none"},I=F[t.swipeDirection];n.css({"-ms-touch-action":I,"touch-action":I}).bind(P,R).bind(D,q)},arrow_nav:function(){c.append('<span class="carouselps-arrow prev" data-direction="prev"><a></a></span><span class="carouselps-arrow next" data-direction="next"><a></a></span>');c.children(".carouselps-arrow").bind("click",function(){b=e(this).data("direction");C.animate();if(typeof t.arrow_click=="function"){t.arrow_click(n,e(this))}})},bottom_nav:function(){if(typeof t.custom_bottom_nav=="object"){d=t.custom_bottom_nav}else{h.append('<ul class="carouselps-nav-bottom"/>');p=h.children(".carouselps-nav-bottom");for(var r=0;r<i;r++){p.append("<li><a></a></li>")}d=p.children()}d.eq(t.starting_slide-1).addClass("current");d.bind("click",function(r){r.preventDefault();if(!e(this).hasClass("current")){m=e(this).index();b="bottom";C.animate()}if(typeof t.bottom_nav_click=="function"){t.bottom_nav_click(n,e(this))}})}};C.init();e(window).bind("load",function(){if(t.adjust_height){n.height(a.height())}if(t.responsive){C.calcs()}});if(t.responsive){var k,L=N?window.hasOwnProperty("orientation"):false,A=L?"orientationchange":"resize";e(window).bind(A,function(){if(k){clearTimeout(k)}k=setTimeout(C.calcs,L?0:100)})}})}})(jQuery)